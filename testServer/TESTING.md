# Socket.IO测试指南

## 1. Node.js服务器

### 安装依赖
```bash
npm install
```

### 启动服务器
```bash
npm start
```

服务器将在 `http://localhost:3000` 上运行，支持以下功能：
- 连接/断开连接事件
- 聊天消息广播
- 自定义事件处理
- 定期心跳消息

## 2. HTML测试页面

### 打开测试页面
直接在浏览器中打开 `test.html` 文件。

### 功能说明
- **连接/断开连接**：连接到本地或远程Socket.IO服务器
- **发送消息**：发送聊天消息到服务器，并接收ACK响应
- **接收消息**：接收来自服务器的广播消息
- **自定义事件**：发送和接收自定义事件
- **心跳监控**：显示服务器发送的心跳消息

## 3. iOS Demo应用

### 修改服务器地址
在 `ViewController.m` 文件中，修改 `socketExample` 方法中的 `urlString` 变量，指向您的Socket.IO服务器地址。

### 功能说明
- **连接服务器**：点击"Connect Server"按钮连接到服务器
- **发送消息**：点击"Send Message"按钮发送测试消息
- **断开连接**：点击"Disconnect"按钮断开连接

### 日志输出
应用会在控制台输出详细的日志信息，包括：
- 连接状态变化
- 收到的消息
- 发送的消息
- 心跳消息

## 4. 测试流程

### 基本测试
1. 启动Node.js服务器
2. 打开HTML测试页面，连接到服务器
3. 运行iOS Demo应用，连接到同一服务器
4. 在HTML页面或iOS应用中发送消息，观察双向通信

### ACK响应测试
1. 启动服务器
2. 在HTML页面连接服务器
3. 发送消息，观察ACK响应
4. 在iOS应用中发送带ACK的消息，观察控制台输出

### 广播测试
1. 启动服务器
2. 打开两个或多个HTML测试页面，连接到服务器
3. 在一个页面发送消息，观察其他页面是否收到广播
4. 运行iOS应用，发送消息，观察HTML页面是否收到广播

## 5. 服务器API

### 事件列表
- **welcome**：服务器连接成功后发送给客户端的欢迎消息
- **chatMessage**：聊天消息事件，支持ACK响应
- **customEvent**：自定义事件，支持ACK响应
- **heartbeat**：每5秒发送一次的心跳消息

### 示例消息格式

#### 发送聊天消息
```json
{
  "message": "Hello from client",
  "timestamp": 1634567890
}
```

#### 接收聊天消息
```json
{
  "sender": "socket-id",
  "message": "Hello from another client",
  "timestamp": "2025-12-11T12:34:56.789Z"
}
```

## 6. 注意事项

1. 确保Node.js服务器已启动，且端口未被占用
2. 检查防火墙设置，确保端口3000可以访问
3. 在iOS模拟器中，使用 `localhost` 或 `127.0.0.1` 连接本地服务器
4. 在真实设备上测试时，需要使用服务器的真实IP地址

## 7. 故障排除

### 无法连接到服务器
- 检查服务器是否正在运行
- 检查防火墙设置
- 检查服务器URL和端口是否正确

### 消息无法发送或接收
- 检查连接状态
- 查看控制台日志
- 检查服务器日志输出

### ACK响应超时
- 检查网络连接
- 检查服务器处理逻辑
- 调整超时时间设置

## 8. 扩展功能

可以根据需要修改 `server.js` 文件，添加更多自定义事件和功能：

- 房间管理
- 用户认证
- 消息历史记录
- 性能监控

## 9. 跨平台测试

该测试环境支持：
- iOS应用
- Web浏览器
- Android应用（需自行实现）
- 其他Socket.IO客户端

通过这种方式，可以全面测试Socket.IO客户端库的跨平台兼容性和稳定性。
